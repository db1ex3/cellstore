'Impute rules for fundamental accounting concepts
'Version 2014-09-25



'Balance sheet
	

    'Determine which statements are used
    IsClassifiedBalanceSheet = CurrentAssets

	
    'BS-Impute-01: If Assets was not reported; and the balance sheet does not balance; then see if CurrentAssets was reported instead of Assets; make Assets the same value as CurrentAssets.
    If Assets = 0 and NoncurrentAssets = 0 and Assets <> LiabilitiesAndEquity and CurrentAssets = LiabilitiesAndEquity Then
        Assets = CurrentAssets
    End If
    
    'BS-Impute-02: If Assets is 0 and LiabilitiesAndEquity is NOT 0 and CurrentAssets equals LiabilitiesAndEquity; then Assets must equal CurrentAssets
    If Assets = 0 and LiabilitiesAndEquity <> 0 and CurrentAssets = LiabilitiesAndEquity Then
        Assets = CurrentAssets
    End If
    
    'BS-Impute-03: 
    If Assets = 0 and NoncurrentAssets = 0 and LiabilitiesAndEquity <> 0 and (LiabilitiesAndEquity = Liabilities + Equity) Then
        Assets = CurrentAssets
    End If
    
    'BS-Impute-04:
    If NoncurrentAssets = 0 and Assets <> 0 and CurrentAssets <> 0 Then
        NoncurrentAssets = Assets - CurrentAssets
    End If
    
    'BS-Impute-05: 
    If LiabilitiesAndEquity = 0 and Assets <> 0 Then
        LiabilitiesAndEquity = Assets
    End If
    
    'BS-Impute-06: If Equity was not reported but EquityAttributableToParent and EquityAttributableToNoncontrollingInterest were reported; then Equity must equal the parent plus noncontrolling interest
    If Equity = 0 and EquityAttributableToNoncontrollingInterest <> 0 and EquityAttributableToParent <> 0 Then
        Equity = EquityAttributableToParent + EquityAttributableToNoncontrollingInterest
    End If
    
    'BS-Impute-07:
    If Equity = 0 and EquityAttributableToNoncontrollingInterest = 0 and EquityAttributableToParent <> 0 Then
        Equity = EquityAttributableToParent
    End If
    
    'BS-Impute-08:
    If Equity = 0 Then
        Equity = EquityAttributableToParent + EquityAttributableToNoncontrollingInterest
    End If
    
    'BS-Impute-09: Impute EquityAttributableToParent based on existence of EquityAttributableToNoncontrollingInterest.
    If EquityAttributableToParent = 0 and Equity <> 0 and EquityAttributableToNoncontrollingInterest <> 0 Then
        EquityAttributableToParent = Equity - EquityAttributableToNoncontrollingInterest
    End If
    
    'BS-Impute-10: Impute EquityAttributableToParent based on existence of EquityAttributableToNoncontrollingInterest.
    If EquityAttributableToParent = 0 and Equity <> 0 and EquityAttributableToNoncontrollingInterest = 0 Then
        EquityAttributableToParent = Equity
    End If
    
    'BS-Impute-11: If Liabilities was not reported; impute value based on LiabilitiesAndEquity
    If Liabilities = 0 and (Equity <> 0) Then
        ' (added redeemable noncontrolling interest to computation)   Liabilities = LiabilitiesAndEquity - (CommitmentsAndContingencies + TemporaryEquity + Equity)
        Liabilities = LiabilitiesAndEquity - (CommitmentsAndContingencies + TemporaryEquity + RedeemableNoncontrollingInterest + Equity)
    End If
    
    'BS-Impute-12: added noncurrent liabilities = 0 to if statement
    If NoncurrentLiabilities = 0 and Liabilities <> 0 and CurrentLiabilities <> 0 Then
        NoncurrentLiabilities = Liabilities - CurrentLiabilities
    End If
    
    'BS-Impute-13:
    If Liabilities = 0 and CurrentLiabilities <> 0 and NoncurrentLiabilities = 0 Then
        Liabilities = CurrentLiabilities
    End If
    
    'BS-Impute-14: Added to fix CRYSLER
    If Liabilities = 0 and CurrentLiabilities <> 0 and NoncurrentLiabilities <> 0 Then
        Liabilities = CurrentLiabilities + NoncurrentLiabilities
    End If

    'BS-Impute-15: Added 2014-09-29 to try and fix BS1 type error where equity attributable to parent subtotal not reported, but equity and noncontrolling interest are reported
    If EquityAttributableToParent <> 0 and Equity <> 0 and EquityAttributableToNoncontrollingInterest <> 0 and EquityAttributableToParent = Equity Then
        EquityAttributableToParent = Equity - EquityAttributableToNoncontrollingInterest
    End If

    'BS-Impute-16: Added 2014-09-30 to try and fix BS4 type error where filer reports liabilities rather than current liabilities
    If CurrentLiabilities = 0 and NoncurrentLiabilities = 0 and Liabilities <> 0 Then
        CurrentLiabilities = Liabilities
    End If

    
'VERIFICATION RULES: Balance Sheet Concepts


    BS1 = Equity - (EquityAttributableToParent + EquityAttributableToNoncontrollingInterest)
    BS2 = Assets - LiabilitiesAndEquity

    'IsClassifiedBalanceSheet = CurrentAssets = 0 and NoncurrentAssets = 0 and CurrentLiabilities = 0 and NoncurrentLiabilities = 0
    If IsClassifiedBalanceSheet = 0 Then
        'If current assets/liabilities are zero and noncurrent assets/liabilities; then don't do this test because the balance sheet is not classified
        BS3 = 0
        BS4 = 0
    Else
        'This is a classified balance sheet
        BS3 = Assets - (CurrentAssets + NoncurrentAssets)
        BS4 = Liabilities - (CurrentLiabilities + NoncurrentLiabilities)
    End If
    

    BS5 = LiabilitiesAndEquity - (Liabilities + CommitmentsAndContingencies + TemporaryEquity + RedeemableNoncontrollingInterest + Equity)
        





'Income statement:

    'Adjustments to income statement information
    'IS-Impute-01: NonoperatingIncomeLossPlusInterestAndDebtExpense
    NonoperatingIncomeLossPlusInterestAndDebtExpense = NonoperatingIncomeLoss - InterestAndDebtExpense
    
    'IS-Impute-02: NetIncomeLoss
    If IncomeLossFromContinuingOperationsAfterTax = 0 and NetIncomeLoss <> 0 Then
        IncomeLossFromContinuingOperationsAfterTax = NetIncomeLoss - IncomeLossFromDiscontinuedOperationsNetOfTax - ExtraordinaryItemsOfIncomeExpenseNetOfTax
    End If

    'IS-Impute-03: Net income attributable to parent (if it was not reported)
    If NetIncomeLossAttributableToParent = 0 and NetIncomeLossAttributableToNoncontrollingInterest = 0 and NetIncomeLoss <> 0 Then
        NetIncomeLossAttributableToParent = NetIncomeLoss
    End If

    'IS-Impute-03A: FIX Caterpillar and IBM
    If NetIncomeLossAttributableToParent = 0 and NetIncomeLossAttributableToNoncontrollingInterest <> 0 and NetIncomeLoss <> 0 Then
        NetIncomeLossAttributableToParent = NetIncomeLoss - NetIncomeLossAttributableToNoncontrollingInterest
    End If


    'IS-Impute-04: Net income available to common stockholders (if it was not reported)
    If NetIncomeLossAvailableToCommonStockholdersBasic = 0 and PreferredStockDividendsAndOtherAdjustments = 0 and NetIncomeLossAttributableToParent <> 0 Then
        NetIncomeLossAvailableToCommonStockholdersBasic = NetIncomeLossAttributableToParent
    End If
            
    'IS-Impute-05: PreferredStockDividendsAndOtherAdjustments (if it was not reported)
    If PreferredStockDividendsAndOtherAdjustments = 0 and NetIncomeLossAttributableToParent <> 0 and NetIncomeLossAvailableToCommonStockholdersBasic <> 0 Then
        PreferredStockDividendsAndOtherAdjustments = NetIncomeLossAttributableToParent - NetIncomeLossAvailableToCommonStockholdersBasic
    End If

    'IS-Impute-06: comprehensive income (if it was not reported)
    If ComprehensiveIncomeLoss = 0 and ComprehensiveIncomeLossAttributableToParent = 0 and ComprehensiveIncomeLossAttributableToNoncontrollingInterest = 0 and OtherComprehensiveIncomeLoss = 0 Then
        ComprehensiveIncomeLoss = NetIncomeLoss
    End If
            
    'IS-Impute-07: other comprehensive income (if it was not reported)
    If OtherComprehensiveIncomeLoss = 0 and ComprehensiveIncomeLoss <> 0 Then
        OtherComprehensiveIncomeLoss = ComprehensiveIncomeLoss - NetIncomeLoss
    End If

    'IS-Impute-08: comprehensive income attributable to parent  (if it was not reported)
    If ComprehensiveIncomeLossAttributableToParent = 0 and ComprehensiveIncomeLossAttributableToNoncontrollingInterest = 0 and ComprehensiveIncomeLoss <> 0 Then
        ComprehensiveIncomeLossAttributableToParent = ComprehensiveIncomeLoss
    End If

    'IS-Impute-08A: Fix Walt Disney
    If ComprehensiveIncomeLossAttributableToNoncontrollingInterest = 0 and ComprehensiveIncomeLossAttributableToParent <> 0 and ComprehensiveIncomeLoss <> 0 Then
        ComprehensiveIncomeLossAttributableToNoncontrollingInterest = ComprehensiveIncomeLoss - ComprehensiveIncomeLossAttributableToParent
    End If

    'IS-Impute-09: IncomeFromContinuingOperations*Before*Tax (if it was not reported)
    If IncomeLossFromContinuingOperationsBeforeTax = 0 and IncomeLossBeforeEquityMethodInvestments <> 0 and IncomeLossFromEquityMethodInvestments <> 0 Then
        IncomeLossFromContinuingOperationsBeforeTax = IncomeLossBeforeEquityMethodInvestments + IncomeLossFromEquityMethodInvestments
    End If
            
    'IS-Impute-10: IncomeFromContinuingOperations*Before*Tax2  (if it was not reported)
    If IncomeLossFromContinuingOperationsBeforeTax = 0 and IncomeLossFromContinuingOperationsAfterTax <> 0 Then
        IncomeLossFromContinuingOperationsBeforeTax = IncomeLossFromContinuingOperationsAfterTax + IncomeTaxExpenseBenefit
    End If
            
    'IS-Impute-11: IncomeFromContinuingOperations*After*Tax (if it was not reported)
    If IncomeLossFromContinuingOperationsAfterTax = 0 and (IncomeTaxExpenseBenefit <> 0 Or IncomeTaxExpenseBenefit = 0 and IncomeLossFromContinuingOperationsBeforeTax <> 0) Then
        IncomeLossFromContinuingOperationsAfterTax = IncomeLossFromContinuingOperationsBeforeTax - IncomeTaxExpenseBenefit
    End If
            
            
    'IS-Impute-12: GrossProfit (if it was not reported)
    If GrossProfit = 0 and (Revenues <> 0 and CostOfRevenue <> 0) Then
        GrossProfit = Revenues - CostOfRevenue
    End If
            
    'IS-Impute-13: GrossProfit (if it was not reported)
    If GrossProfit = 0 and (Revenues <> 0 and CostOfRevenue <> 0) Then
        GrossProfit = Revenues - CostOfRevenue
    End If
            
    'IS-Impute-14: Revenues (if it was not reported)
    If GrossProfit <> 0 and (Revenues = 0 and CostOfRevenue <> 0) Then
        Revenues = GrossProfit + CostOfRevenue
    End If
            
    'IS-Impute-15: CostOfRevenue (if it was not reported)
    If GrossProfit <> 0 and (Revenues <> 0 and CostOfRevenue = 0) Then
        CostOfRevenue = GrossProfit + Revenues
    End If
 
    'IS-Impute-16: CostsAndExpenses  (if it was not reported)
    If GrossProfit = 0 and CostsAndExpenses = 0 and (CostOfRevenue <> 0 and OperatingExpenses <> 0) Then
        CostsAndExpenses = CostOfRevenue + OperatingExpenses
    End If
            
    'IS-Impute-17: CostsAndExpenses based on existance of both costs of revenues and operating expenses (if it was not reported)
    If CostsAndExpenses = 0 and OperatingExpenses <> 0 and (CostOfRevenue <> 0) Then
        CostsAndExpenses = CostOfRevenue + OperatingExpenses
    End If
            
    'IS-Impute-18: CostsAndExpenses (if it was not reported)
    If GrossProfit = 0 and CostsAndExpenses = 0 and Revenues <> 0 and OperatingIncomeLoss <> 0 and OtherOperatingIncomeExpenses <> 0 Then
        CostsAndExpenses = Revenues - OperatingIncomeLoss - OtherOperatingIncomeExpenses
    End If
            
    'IS-Impute-19: OperatingExpenses based on existance of costs and expenses and cost of revenues (if it was not reported)
    If OperatingExpenses = 0 and CostOfRevenue <> 0 and CostsAndExpenses <> 0 Then
        OperatingExpenses = CostsAndExpenses - CostOfRevenue
    End If
            
    'IS-Impute-20: CostOfRevenues single-step method (if it was not reported)
    If CostOfRevenue = 0 and Revenues <> 0 and GrossProfit = 0 and (Revenues - CostsAndExpenses = OperatingIncomeLoss and OperatingExpenses = 0 and OtherOperatingIncomeExpenses = 0) Then
        CostOfRevenue = CostsAndExpenses - OperatingExpenses
    End If

    'IS-Impute-21: IncomeLossBeforeEquityMethodInvestments (if it was not reported)
    If IncomeLossBeforeEquityMethodInvestments = 0 and IncomeLossFromContinuingOperationsBeforeTax <> 0 Then
        IncomeLossBeforeEquityMethodInvestments = IncomeLossFromContinuingOperationsBeforeTax - IncomeLossFromEquityMethodInvestments
    End If
            
    'IS-Impute-22: IncomeLossBeforeEquityMethodInvestments (if it was not reported)
    If InterestAndDebtExpense = 0 and OperatingIncomeLoss <> 0 and (NonoperatingIncomeLoss <> 0 and IncomeLossBeforeEquityMethodInvestments <> 0) Then
        InterestAndDebtExpense = IncomeLossBeforeEquityMethodInvestments - (OperatingIncomeLoss + NonoperatingIncomeLoss)
    End If
    
    'IS-Impute-23: OtherOperatingIncomeExpenses (if it was not reported)
    If OtherOperatingIncomeExpenses = 0 and GrossProfit <> 0 and (OperatingExpenses <> 0 and OperatingIncomeLoss <> 0) Then
        OtherOperatingIncomeExpenses = OperatingIncomeLoss - (GrossProfit - OperatingExpenses)
    End If

    'IS-Impute-24: Move IncomeLossFromEquityMethodInvestments (if it was not reported)
    If IncomeLossFromEquityMethodInvestments <> 0 and IncomeLossBeforeEquityMethodInvestments <> 0 and IncomeLossBeforeEquityMethodInvestments <> IncomeLossFromContinuingOperationsBeforeTax Then
        IncomeLossBeforeEquityMethodInvestments = IncomeLossFromContinuingOperationsBeforeTax - IncomeLossFromEquityMethodInvestments
		  'CSH Disabled        OperatingIncomeLoss = OperatingIncomeLoss - IncomeLossFromEquityMethodInvestments
    End If
    
    'DANGEROUS!!
    'IS-Impute-25: OperatingIncomeLoss
    If OperatingIncomeLoss = 0 and IncomeLossBeforeEquityMethodInvestments <> 0 Then
        OperatingIncomeLoss = IncomeLossBeforeEquityMethodInvestments + NonoperatingIncomeLoss - InterestAndDebtExpense
    End If
            
	 'IS-Impute-26:
    If NonoperatingIncomePlusInterestAndDebtExpensePlusIncomeFromEquityMethodInvestments = 0 Then
    		NonoperatingIncomePlusInterestAndDebtExpensePlusIncomeFromEquityMethodInvestments = IncomeLossFromContinuingOperationsBeforeTax - OperatingIncomeLoss
    End If
     
	 'IS-Impute-27: NonoperatingIncomeLossPlusInterestAndDebtExpense
    If NonoperatingIncomeLossPlusInterestAndDebtExpense = 0 and NonoperatingIncomePlusInterestAndDebtExpensePlusIncomeFromEquityMethodInvestments <> 0 Then
        NonoperatingIncomeLossPlusInterestAndDebtExpense = NonoperatingIncomePlusInterestAndDebtExpensePlusIncomeFromEquityMethodInvestments - IncomeLossFromEquityMethodInvestments
    End If
 

    'Determine if income statement is multi-step or single-step
    IsMultiStepIncomeStatement = GrossProfit

'VERIFICATION RULES: Income statement
'Rules IS2, IS3, IS4, and IS11 are disabled until more is learned about the pieces of operating income (loss)

    If IsMultiStepIncomeStatement = 0 Then
        IS1 = 0
        IS2 = 0
    Else
        'Multi-step only
        IS1 = GrossProfit - (Revenues - CostOfRevenue) 
'        IS2 = OperatingIncomeLoss - (GrossProfit - OperatingExpenses + OtherOperatingIncomeExpenses)
    End If
        
'    IS3 =  IncomeLossBeforeEquityMethodInvestments - (OperatingIncomeLoss + NonoperatingIncomeLossPlusInterestAndDebtExpense)
'    IS4 = IncomeLossFromContinuingOperationsBeforeTax - (IncomeLossBeforeEquityMethodInvestments + IncomeLossFromEquityMethodInvestments)
    IS5 = IncomeLossFromContinuingOperationsAfterTax - (IncomeLossFromContinuingOperationsBeforeTax - IncomeTaxExpenseBenefit)
    IS6 = NetIncomeLoss - (IncomeLossFromContinuingOperationsAfterTax + IncomeLossFromDiscontinuedOperationsNetOfTax + ExtraordinaryItemsOfIncomeExpenseNetOfTax)
    IS7 = NetIncomeLoss - (NetIncomeLossAttributableToParent + NetIncomeLossAttributableToNoncontrollingInterest)
    IS8 = NetIncomeLossAvailableToCommonStockholdersBasic - (NetIncomeLossAttributableToParent - PreferredStockDividendsAndOtherAdjustments)
    IS9 = ComprehensiveIncomeLoss - (ComprehensiveIncomeLossAttributableToParent + ComprehensiveIncomeLossAttributableToNoncontrollingInterest)
    IS10 = ComprehensiveIncomeLoss - (NetIncomeLoss + OtherComprehensiveIncomeLoss)

    If IsMultiStepIncomeStatement = 0 Then
        'Single-step only
'        IS11 = OperatingIncomeLoss - (Revenues - CostsAndExpenses + OtherOperatingIncomeExpenses)
    Else
        IS11 = 0
    End If



'Cash flow statement

    'CF-Impute-00: Added 2014-09-25
    If NetCashFlow = 0 and NetCashFlowContinuing <> 0 and NetCashFlowDiscontinued <> 0 Then
        NetCashFlow = NetCashFlowContinuing + NetCashFlowDiscontinued + ExchangeGainsLosses
    End If

    'CF-Impute-01: NetCashFlowDiscontinued if not reported
    If NetCashFlowDiscontinued = 0 Then
        NetCashFlowDiscontinued = NetCashFlowFromOperatingActivitiesDiscontinued + NetCashFlowFromInvestingActivitiesDiscontinued + NetCashFlowFromFinancingActivitiesDiscontinued
    End If

    'CF-Impute-02: NetCashFlowFromOperatingActivitiesContinuing if not reported
    If NetCashFlowFromOperatingActivities <> 0 and NetCashFlowFromOperatingActivitiesContinuing = 0 Then
        NetCashFlowFromOperatingActivitiesContinuing = NetCashFlowFromOperatingActivities - NetCashFlowFromOperatingActivitiesDiscontinued
    End If

    'CF-Impute-03: NetCashFlowFromInvestingActivitiesContinuing if not reported
    If NetCashFlowFromInvestingActivities <> 0 and NetCashFlowFromInvestingActivitiesContinuing = 0 Then
        NetCashFlowFromInvestingActivitiesContinuing = NetCashFlowFromInvestingActivities - NetCashFlowFromInvestingActivitiesDiscontinued
    End If

    'CF-Impute-04: NetCashFlowFromFinancingActivitiesContinuing if not reported
    If NetCashFlowFromFinancingActivities <> 0 and NetCashFlowFromFinancingActivitiesContinuing = 0 Then
        NetCashFlowFromFinancingActivitiesContinuing = NetCashFlowFromFinancingActivities - NetCashFlowFromFinancingActivitiesDiscontinued
    End If
    
    'CF-Impute-05: NetCashFlowFromOperatingActivities if not reported
    If NetCashFlowFromOperatingActivities = 0 and NetCashFlowFromOperatingActivitiesContinuing <> 0 and NetCashFlowFromOperatingActivitiesDiscontinued = 0 Then
        NetCashFlowFromOperatingActivities = NetCashFlowFromOperatingActivitiesContinuing
    End If

    'CF-Impute-06: NetCashFlowFromInvestingActivities if not reported
    If NetCashFlowFromInvestingActivities = 0 and NetCashFlowFromInvestingActivitiesContinuing <> 0 and NetCashFlowFromInvestingActivitiesDiscontinued = 0 Then
        NetCashFlowFromInvestingActivities = NetCashFlowFromInvestingActivitiesContinuing
    End If

    'CF-Impute-07: NetCashFlowFromFinancingActivities if not reported
    If NetCashFlowFromFinancingActivities = 0 and NetCashFlowFromFinancingActivitiesContinuing <> 0 and NetCashFlowFromFinancingActivitiesDiscontinued = 0 Then
        NetCashFlowFromFinancingActivities = NetCashFlowFromFinancingActivitiesContinuing
    End If
    
    'CF-Impute-08: NetCashFlowContinuing if not reported
    If NetCashFlowContinuing = 0 Then
        NetCashFlowContinuing = NetCashFlowFromOperatingActivitiesContinuing + NetCashFlowFromInvestingActivitiesContinuing + NetCashFlowFromFinancingActivitiesContinuing
    End If
    
    'CF-Impute-10:  If total = continuing; then impute discontinued to be zero
    If NetCashFlowFromOperatingActivitiesDiscontinued = 0 and NetCashFlowFromOperatingActivities = NetCashFlowFromOperatingActivitiesContinuing Then
        NetCashFlowFromOperatingActivitiesDiscontinued = 0
    End If

    'CF-Impute-11:  If total = continuing; then impute discontinued to be zero
    If NetCashFlowFromInvestingActivitiesDiscontinued = 0 and NetCashFlowFromInvestingActivities = NetCashFlowFromInvestingActivitiesContinuing Then
        NetCashFlowFromInvestingActivitiesDiscontinued = 0
    End If

    'CF-Impute-12:  If total = continuing; then impute discontinued to be zero
    If NetCashFlowFromFinancingActivitiesDiscontinued = 0 and NetCashFlowFromFinancingActivities = NetCashFlowFromFinancingActivitiesContinuing Then
        NetCashFlowFromFinancingActivitiesDiscontinued = 0
    End If

    'CF-Impute-13:  'ADDED 2014-03-08 to fix cash flow CF4, CF5, CF6
    If NetCashFlowFromOperatingActivities = 0 and NetCashFlowFromOperatingActivitiesContinuing <> 0 and NetCashFlowFromOperatingActivitiesDiscontinued <> 0 Then
        NetCashFlowFromOperatingActivities = NetCashFlowFromOperatingActivitiesContinuing + NetCashFlowFromOperatingActivitiesDiscontinued
    End If

    'CF-Impute-14:  'ADDED 2014-03-08 to fix cash flow CF4, CF5, CF6
    If NetCashFlowFromInvestingActivities = 0 and NetCashFlowFromInvestingActivitiesContinuing <> 0 and NetCashFlowFromInvestingActivitiesDiscontinued <> 0 Then
        NetCashFlowFromInvestingActivities = NetCashFlowFromInvestingActivitiesContinuing + NetCashFlowFromInvestingActivitiesDiscontinued
    End If

    'CF-Impute-15:  'ADDED 2014-03-08 to fix cash flow CF4, CF5, CF6
    If NetCashFlowFromFinancingActivities = 0 and NetCashFlowFromFinancingActivitiesContinuing <> 0 and NetCashFlowFromFinancingActivitiesDiscontinued <> 0 Then
        NetCashFlowFromFinancingActivities = NetCashFlowFromFinancingActivitiesContinuing + NetCashFlowFromFinancingActivitiesDiscontinued
    End If

    'CF-Impute-16: NetCashFlow if not reported; If NetCashFlow is missing, then this tries to figure out the value by adding up the detail
    If NetCashFlow = 0 and (NetCashFlowFromOperatingActivities <> 0 or NetCashFlowFromInvestingActivities <> 0 or NetCashFlowFromFinancingActivities <> 0) Then
        NetCashFlow = NetCashFlowFromOperatingActivities + NetCashFlowFromInvestingActivities + NetCashFlowFromFinancingActivities + ExchangeGainsLosses
    End If




'VERIFICATION RULES: Cash flow statement

    CF1 = NetCashFlow - (NetCashFlowFromOperatingActivities + NetCashFlowFromInvestingActivities + NetCashFlowFromFinancingActivities + ExchangeGainsLosses)
    
    If CF1 <> 0 and (NetCashFlow - (NetCashFlowFromOperatingActivities + NetCashFlowFromInvestingActivities + NetCashFlowFromFinancingActivities + ExchangeGainsLosses)) = (ExchangeGainsLosses * -1) Then
      'NetCashFlow DOES NOT include ExchangeGainsLosses for about 128 SEC filers, it does for about 7040 SEC filers
    	CF1 = NetCashFlow - (NetCashFlowFromOperatingActivities + NetCashFlowFromInvestingActivities + NetCashFlowFromFinancingActivities)

    End If
    
    
    CF2 = NetCashFlowContinuing - (NetCashFlowFromOperatingActivitiesContinuing + NetCashFlowFromInvestingActivitiesContinuing + NetCashFlowFromFinancingActivitiesContinuing)
    CF3 = NetCashFlowDiscontinued - (NetCashFlowFromOperatingActivitiesDiscontinued + NetCashFlowFromInvestingActivitiesDiscontinued + NetCashFlowFromFinancingActivitiesDiscontinued)
    CF4 = NetCashFlowFromOperatingActivities - (NetCashFlowFromOperatingActivitiesContinuing + NetCashFlowFromOperatingActivitiesDiscontinued)
    CF5 = NetCashFlowFromInvestingActivities - (NetCashFlowFromInvestingActivitiesContinuing + NetCashFlowFromInvestingActivitiesDiscontinued)
    CF6 = NetCashFlowFromFinancingActivities - (NetCashFlowFromFinancingActivitiesContinuing + NetCashFlowFromFinancingActivitiesDiscontinued)
    
    


'Key ratios

    If (Assets <> 0) and (Equity <> 0) and (Revenues <> 0) Then
        SustainableGrowthRate = ((NetIncomeLoss / Revenues) * (1+((Assets - Equity) / Equity))) / ((1 / (Revenues / Assets))-(((NetIncomeLoss / Revenues) * (1+(((Assets - Equity) / Equity))))))
    End If

    If Assets <> 0 Then
        ReturnOnAssets = NetIncomeLoss / Assets
    End If

    If Equity <> 0 Then
        ReturnOnEquity = NetIncomeLoss / Equity
    End If

    If Revenues <> 0 Then
        ReturnOnSales = NetIncomeLoss / Revenues
    End If
