<div class="menu">
    <div class="btn-group">
        <a class="btn btn-default" ng-model="page" btn-radio="'/views/comparison.html'" href="/comparison"><i class="fa fa-home"></i></a>
        <a class="btn btn-default" ng-model="page" btn-radio="'/views/comparison-information.html'" href="/comparison/information"><i class="fa fa-th-large"></i> Basic Financial Information</a>
        <a class="btn btn-default" ng-model="page" btn-radio="'/views/comparison-search.html'" href="/comparison/search"><i class="fa fa-search"></i> Compare Facts</a>
    </div>
</div>

<div class="cols row">
	<div class="col-left col-md-3 col-sm-4 col-xs-12 selection" ng-include="'/views/comparison-filter.html'"></div>
	<div class="col-right col-md-9 col-sm-8 col-xs-12">
		<div>
			<h2>Retrieve facts and concepts values from the SEC filings</h2>
            <div>
				<div>
                   <label>
                      Concept map
                   </label> &nbsp;<br class="visible-sm visible-xs"> 
                   <span style="display: inline-block;">
                      <select ng-model="selection.conceptMap" ng-options="map for map in conceptMaps" class="form-control"></select>
                   </span>
                   <a href="/concept-map/{{selection.conceptMap}}" ng-if="selection.conceptMap!=none"><i class="fa fa-question"></i></a>
                </div>

                <h4>Concepts</h4>
                
                <div class="input-group">
                  <input type="text" ng-model="conceptMapKey" placeholder="Type to search concept" class="form-control"
                                     typeahead="key for key in conceptMapKeys | filter:$viewValue | limitTo: 20" ng-enter="addConceptKey(conceptMapKey)">
                  <div class="input-group-btn">
                    <button class="btn btn-primary" ng-click="addConceptKey(conceptMapKey)">Add</button>
                  </div>
                </div>
                
                <div>
                    <div ng-repeat="key in selection.conceptMapKeys">
                        <a ng-click="selection.conceptMapKeys.splice(selection.conceptMapKeys.indexOf(key), 1)"><i class="fa fa-times"></i></a>
                        <a popover="{{key}}" popover-position="top" popover-trigger="focus">{{substring(key, 50)}}</a>
                    </div>
                </div>

                <h4>Dimensions <a ng-click="addDimension()"><i class="fa fa-plus-square-o"></i></a></h4>
                <div ng-repeat="key in selection.dimensions">
                    <a ng-click="selection.dimensions.splice(selection.dimensions.indexOf(key), 1)"><i class="fa fa-times"></i></a>
                    {{ key.name }} = {{ key.value }}
                </div>
                <div ng-hide="selection.dimensions.length">
                    No dimension filters used.
                </div>
                
                <script type="text/ng-template" id="dimension.html">
                    <div class="modal-header">
                		<button type="button" class="close" ng-click="cancel()" aria-hidden="true">&times;</button>
                        <h4>Add a new dimension</h4>
                    </div>
                    <form role="form" name="dimension.form" ng-submit="ok()" novalidate>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Name</label>
                                <input type="text" name="name" ng-model="dimension.name" placeholder="like dei:LegalEntityAxis" class="form-control" required>
                                <div class="validation-error" ng-show="dimension.form.name.$error.required && (dimension.form.name.$dirty || dimension.attempted)">
                                    Dimension name is required.
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Value</label>
                                <input type="text" name="value" ng-model="dimension.value" placeholder="like sec:DefaultLegalEntity" class="form-control" required>
                                <div class="validation-error" ng-show="dimension.form.value.$error.required && (dimension.form.value.$dirty || dimension.attempted)">
                                    Dimension value is required.
                                </div>
                                write ALL to get all the values of the dimension
                            </div>
                            <div class="form-group">
                                <label>Default Value</label>
                                <input type="text" ng-model="dimension.defaultValue" placeholder="like sec:DefaultLegalEntity" class="form-control">
                                will be used in comparisons where the dimension is missing
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-green" type="submit">OK</button>
                            <button class="btn btn-default" ng-click="cancel()" type="button">Cancel</button>
                        </div>
                    </form>
                </script>
                
				<div>
					<div>
						<button class="btn btn-primary" class="form-control" ng-click="getValues()">GO</button>
					</div>
				</div>
            </div>
		</div>

        <div class="col-md-12">
            <div ng-if="data" class="spaced">
              <input type="text" class="form-control" ng-model="search" placeholder="Type here to search..."/>
              <div class="scrolling">
              <table class="table table-striped table-condensed small">
                  <thead>
                    <th>#</th>
                    <th ng-repeat="key in enumerateKeys(data[0].Aspects)">{{key}}</th>
                    <th>Value</th>
                    <th>Unit</th>
                    <th>Decimals</th>
                  </thead>
                  <tbody>
                    <tr ng-repeat="item in data | filter : search">
                      <td>{{$index + 1}}</td>
                      <td ng-repeat="value in enumerate(item.Aspects)" class="nowrap"><span ng-if="$index==entityIndex">{{value.substring(23)}} ({{item.EntityRegistrantName}})</span><span ng-if="$index!=entityIndex">{{value}}</span></td>
                      <td ng-if="(item.Type == 'NumericValue')" style="text-align: right">{{showNumber(item.Value)}}</td>
                      <td ng-if="(item.Type != 'NumericValue' && !isBlock(item.Value))">{{item.Value}}</td>
                      <td ng-if="(item.Type != 'NumericValue' && isBlock(item.Value))"><a ng-click="showText(item.Value)">Show Text</a></td>
                      <td>{{item.Unit=='xbrl:NonNumeric'?"":clear(item.Unit)}}</td>
                      <td>{{item.Decimals}}</td>
                    </tr>
                  </tbody>
              </table>
              </div>
          </div>
          <div class="col-md-12 text-right" ng-if="data">
            All data as:
              <a href="{{getUrl('json')}}" download="comparison-search.json" target="_blank">JSON</a>,
              <a href="{{getUrl('xml')}}" download="comparison-search.xml" target="_blank">XML</a>,
              <a href="{{getUrl('csv')}}" download="comparison-search.csv" target="_blank">CSV</a>,
              <a href="{{getUrl('excel')}}" download="comparison-search.csv" target="_blank">Excel</a>
            </div>
        </div>

	</div>
</div>
