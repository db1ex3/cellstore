<div ng-controller="ComparisonFilterCtrl" ng-show="selection" id="comparison-filter">
    <h4>Selected Filters</h4>
    <div>
        <div>
            <h6>ENTITIES OR ENTITY GROUPS</h6>
            <div class="alert alert-success" ng-repeat="t in selection.tag">
                <a class="close" ng-click="selection.tag.splice($index, 1)">&times;</a>
                {{t}}
            </div>
            <div class="alert alert-info" ng-repeat="c in selection.cik">
                <a class="close" ng-click="selection.cik.splice($index, 1)">&times;</a>
                {{getEntity(c).name}}
            </div>
        </div>
    </div>
    <div>
        <div>
            <h6>FISCAL YEARS</h6>
            <div class="alert alert-danger" ng-repeat="y in selection.fiscalYear">
                <a class="close" ng-click="selection.fiscalYear.splice($index, 1)">&times;</a>
                {{y}}
            </div>
        </div>
    </div>
    <div>
        <div>
            <h6>FISCAL PERIODS</h6>
            <div class="alert alert-warning" ng-repeat="p in selection.fiscalPeriod">
                <a class="close" ng-click="selection.fiscalPeriod.splice($index, 1)">&times;</a>
                {{p}}
            </div>
        </div>  
    </div>
    <div>
        <a class="pull-right" ng-click="reset()">RESET</a>
        <h4>Set Filters</h4>
        <div>
            <div>
                <h6>ADD ENTITY</h6>
                <input class="form-control" type="text" ng-model="name" typeahead-on-select="selectEntity($item)"
                       placeholder="Search for an entity..."
                       typeahead-template-url="typeaheadmulti.html"
                       typeahead="entity.name for entity in entities | filter:$viewValue | limitTo:8">
                <script type="text/ng-template" id="typeaheadmulti.html">
                    <a tabindex="-1" class="multicol">
                       <div ng-bind-html='match.model.name | typeaheadHighlight:query'></div>
                       <small ng-bind-html='"CIK: " + match.model.cik + (match.model.tickers[0] ? ", Ticker: " + match.model.tickers[0] : "") | typeaheadHighlight:query'></small>
                    </a>
                </script>
                <h6 class="nowrap">OR ADD AN ENTITY GROUP</h6>
                <span ng-repeat="t in tags">
                    <a class="highlight3" ng-click="(selection.tag.indexOf(t) >= 0 ? null : selection.tag.push(t))">{{t}}</a>&nbsp;
                </span>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-6">
                <h6 class="nowrap">ADD FISCAL YEARS</h6>
                <ul class="selector" style="height: 97px">
                    <li ng-repeat="y in years" ng-class="{ selected: (selection.fiscalYear.indexOf(y) >= 0) }" ng-click="(selection.fiscalYear.indexOf(y) >= 0 ? selection.fiscalYear.splice(selection.fiscalYear.indexOf(y), 1) : selection.fiscalYear.push(y))">{{y}}</li>
                </ul>
            </div>
            <div class="col-xs-6">
                <h6 class="nowrap">ADD FISCAL PERIODS</h6>
                <ul class="selector" style="height: 97px">
                    <li ng-repeat="p in periods" ng-class="{ selected: (selection.fiscalPeriod.indexOf(p) >= 0) }" ng-click="(selection.fiscalPeriod.indexOf(p) >= 0 ? selection.fiscalPeriod.splice(selection.fiscalPeriod.indexOf(p), 1) : selection.fiscalPeriod.push(p))">{{p}}</li>
                </ul>
            </div>
        </div>
    </div>
</div>
